!function(s){var a=function(a,n,i,e=null){s.ajax({url:ga_add_ons_js_vars.ajaxurl,type:"post",data:{action:"grid_accordion_verify_add_on_license_key",add_on_slug:n,license_key:a,nonce:i},error:function(s){var a={status:"not_valid",message:s.statusText};e.fail(a)},success:function(s){var a=JSON.parse(s);"valid"===a.status&&void 0!==e.success?e.success(a):"valid"!==a.status&&void 0!==e.fail&&e.fail(a)},complete:function(){void 0!==e.always&&e.always()}})},n=function(a,n,i,e){s.ajax({url:ga_add_ons_js_vars.ajaxurl,type:"post",data:{action:"grid_accordion_install_add_on",add_on_slug:n,license_key:a,nonce:i},error:function(s){var a={status:"not_installed",message:s.statusText};void 0!==e.fail&&e.fail(a)},success:function(s){var a=JSON.parse(s);"installed"===a.status&&void 0!==e.success?e.success(a):"installed"!==a.status&&void 0!==e.fail&&e.fail(a)},complete:function(){void 0!==e.always&&e.always()}})},i=function(a,n,i){s.ajax({url:ga_add_ons_js_vars.ajaxurl,type:"post",data:{action:"grid_accordion_activate_add_on",add_on_slug:a,nonce:n},error:function(s){var a={status:"not_activated",message:s.statusText};void 0!==i.fail&&i.fail(a)},success:function(s){var a=JSON.parse(s);"activated"===a.status&&void 0!==i.success?i.success(a):"activated"!==a.status&&void 0!==i.fail&&i.fail(a)},complete:function(){void 0!==i.always&&i.always()}})},e=function(a,n,i){s.ajax({url:ga_add_ons_js_vars.ajaxurl,type:"post",data:{action:"grid_accordion_deactivate_add_on",add_on_slug:a,nonce:n},error:function(s){var a={status:"not_deactivated",message:s.statusText};void 0!==i.fail&&i.fail(a)},success:function(s){var a=JSON.parse(s);"deactivated"===a.status&&void 0!==i.success?i.success(a):"deactivated"!==a.status&&void 0!==i.fail&&i.fail(a)},complete:function(){void 0!==i.always&&i.always()}})},t={$installAddOnWindow:null,addOnSlug:"",licenseKey:"",nonce:{},$installButton:null,$submitButton:null,$installLog:null,$installLogRow:null,reloadPageOnClose:!1,open:function(a){var n=this,i=s.lightURLParse(a.attr("href"));this.$installButton=a.attr("disabled",!0),this.addOnSlug=i.add_on,this.nonce=JSON.parse(a.attr("data-nonce")),this.reloadPageOnClose=!1,s('<div class="modal-overlay"><span class="modal-overlay-spinner"></span></div>').appendTo("body"),s.ajax({url:ga_add_ons_js_vars.ajaxurl,type:"post",data:{action:"grid_accordion_load_install_add_on",add_on_slug:this.addOnSlug},complete:function(a){s(".modal-overlay-spinner").remove(),n.$installAddOnWindow=s(a.responseText).appendTo("body"),n.init()}})},init:function(){var a=this;this.$submitButton=this.$installAddOnWindow.find(".license-key-submit-button"),this.$installLog=s(".install-log"),this.$installLogRow=s('<div class="install-log-row"><span class="install-log-icon dashicons"></span><p class="install-log-message"></p></div>'),this.$installAddOnWindow.find(".close-x").on("click",(function(s){s.preventDefault(),a.close()})),this.$submitButton.on("click",(function(s){s.preventDefault(),a.$installLog.empty().show(),a._submitInstallAddOnHandler()}))},_submitInstallAddOnHandler:function(){var s=this,n=this.nonce.verify,i=this.$installLogRow.clone().appendTo(this.$installLog),e=i.find(".install-log-icon").addClass("dashicons-update processing-icon"),t=i.find(".install-log-message").text(ga_add_ons_js_vars.check_license_key);this.licenseKey=this.$installAddOnWindow.find(".license-key-input").val(),this.$submitButton.attr("disabled",!0),a(this.licenseKey,this.addOnSlug,n,{success:function(a){e.addClass("dashicons-yes success-icon"),t.text(a.message),s._verifyLicenseKeySuccessHandler()},fail:function(a){"used"===a.status?(e.addClass("dashicons-warning warning-icon"),s._verifyLicenseKeySuccessHandler()):(s.$submitButton.removeAttr("disabled"),e.addClass("dashicons-no-alt fail-icon")),t.text(a.message)},always:function(){e.removeClass("dashicons-update processing-icon")}})},_verifyLicenseKeySuccessHandler:function(){var s=this,a=this.nonce.install,i=this.$installLogRow.clone().appendTo(this.$installLog),e=i.find(".install-log-icon").addClass("dashicons-update processing-icon"),t=i.find(".install-log-message").text(ga_add_ons_js_vars.install_add_on);n(this.licenseKey,this.addOnSlug,a,{success:function(a){e.addClass("dashicons-yes success-icon"),t.text(a.message),s.reloadPageOnClose=!0,s._installAddOnSuccessHandler()},fail:function(a){s.$submitButton.removeAttr("disabled"),e.addClass("dashicons-no-alt fail-icon"),t.text(a.message)},always:function(){e.removeClass("dashicons-update processing-icon")}})},_installAddOnSuccessHandler:function(){var s=this.nonce.activate,a=this.$installLogRow.clone().appendTo(this.$installLog),n=a.find(".install-log-icon").addClass("dashicons-update processing-icon"),e=a.find(".install-log-message").text(ga_add_ons_js_vars.activate_add_on);i(this.addOnSlug,s,{success:function(s){n.addClass("dashicons-yes success-icon"),e.text(s.message),window.location=ga_add_ons_js_vars.admin+"?page=grid-accordion-add-ons"},fail:function(s){n.addClass("dashicons-no-alt fail-icon"),e.text(s.message)},always:function(){n.removeClass("dashicons-update processing-icon")}})},close:function(){this.$installAddOnWindow.find(".close-x").off("click"),this.$submitButton.off("click"),this.$installAddOnWindow.remove(),s(".modal-overlay").remove(),this.$installButton.removeAttr("disabled"),!0===this.reloadPageOnClose&&(window.location=ga_add_ons_js_vars.admin+"?page=grid-accordion-add-ons")}},o={$editLicenseKeyWindow:null,addOnSlug:"",$updateButton:null,open:function(a){var n=this,i=s.lightURLParse(a.attr("href")),e=a.attr("data-nonce");this.addOnSlug=i.add_on,s('<div class="modal-overlay"><span class="modal-overlay-spinner"></span></div>').appendTo("body"),s.ajax({url:ga_add_ons_js_vars.ajaxurl,type:"post",data:{action:"grid_accordion_load_edit_add_on_license_key",add_on_slug:this.addOnSlug,nonce:e},complete:function(a){s(".modal-overlay-spinner").remove(),n.$editLicenseKeyWindow=s(a.responseText).appendTo("body"),n.init()}})},init:function(){var s=this;this.$updateButton=this.$editLicenseKeyWindow.find(".license-key-update-button"),this.$updateButton.on("click",(function(a){a.preventDefault(),s._updateLicenseKeyHandler()})),this.$editLicenseKeyWindow.find(".close-x").on("click",(function(a){a.preventDefault(),s.close()}))},_updateLicenseKeyHandler:function(){var s=this,n=this.$updateButton.attr("data-nonce"),i=this.$editLicenseKeyWindow.find(".license-key-input").val(),e=this.$editLicenseKeyWindow.find(".license-key-info"),t=this.$editLicenseKeyWindow.find(".verify-log");this.$updateButton.attr("disabled",!0),t.show(),t.find(".verify-log-icon").addClass("dashicons-update processing-icon"),t.find(".verify-log-message").text(ga_add_ons_js_vars.check_license_key),e.hide(),e.hasClass("license-key-not-valid")&&e.removeClass("license-key-not-valid"),e.hasClass("license-key-valid")&&e.removeClass("license-key-valid"),a(i,this.addOnSlug,n,{success:function(s){void 0!==s.info?e.html(s.info).addClass("license-key-valid"):void 0!==s.message&&e.html(s.message).addClass("license-key-valid")},fail:function(s){void 0!==s.info?e.html(s.info).addClass("license-key-not-valid"):void 0!==s.message&&e.html(s.message).addClass("license-key-not-valid")},always:function(a){s.$updateButton.removeAttr("disabled"),t.find(".verify-log-icon").removeClass("dashicons-update processing-icon"),t.find(".verify-log-message").empty(),t.hide(),e.show()}})},close:function(){this.$editLicenseKeyWindow.find(".close-x").off("click"),this.$updateButton.off("click"),this.$editLicenseKeyWindow.remove(),s(".modal-overlay").remove()}},d={$moreDetailsWindow:null,addOnSlug:"",open:function(a){var n=this,i=s.lightURLParse(a.attr("href")),e=a.attr("data-nonce");this.addOnSlug=i.add_on,s('<div class="modal-overlay"><span class="modal-overlay-spinner"></span></div>').appendTo("body"),s.ajax({url:ga_add_ons_js_vars.ajaxurl,type:"post",data:{action:"grid_accordion_load_add_on_more_details",add_on_slug:this.addOnSlug,nonce:e},complete:function(a){s(".modal-overlay-spinner").remove(),n.$moreDetailsWindow=s(a.responseText).appendTo("body"),n.init()}})},init:function(){var a=this,n=this.$moreDetailsWindow.find(".modal-window");this.$moreDetailsWindow.find(".close-x").on("click",(function(s){s.preventDefault(),a.close()})),this.$moreDetailsWindow.scrollTop(0),this.$moreDetailsWindow.find(".more-details-screenshots a").attr("target","_blank"),s(window).on("resize.addOnMoreDetails",(function(){n.outerHeight()>=s(window).height()-70?a.$moreDetailsWindow.addClass("modal-window-top"):a.$moreDetailsWindow.removeClass("modal-window-top")})),s(window).trigger("resize")},close:function(){this.$moreDetailsWindow.find(".close-x").off("click"),s(window).off("resize.addOnMoreDetails"),this.$moreDetailsWindow.remove(),s(".modal-overlay").remove()}};s(document).ready((function(){s(".more-details").on("click",(function(a){a.preventDefault(),d.open(s(this))})),s(".edit-license-key").on("click",(function(a){a.preventDefault(),o.open(s(this))})),s(".install-add-on").on("click",(function(a){a.preventDefault(),t.open(s(this))})),s(".activate-add-on").on("click",(function(a){var n=s(this),e=n.find("p"),t=n.find("span"),o=n.attr("data-slug"),d=JSON.parse(n.attr("data-nonce")).activate;a.preventDefault(),n.addClass("disabled"),e.text(ga_add_ons_js_vars.activating),t.attr("class","dashicons dashicons-update processing-icon"),i(o,d,{success:function(){e.text(ga_add_ons_js_vars.activated),t.attr("class","dashicons dashicons-yes success-icon"),window.location=ga_add_ons_js_vars.admin+"?page=grid-accordion-add-ons"},fail:function(){n.removeClass("disabled"),e.text(ga_add_ons_js_vars.try_again),t.attr("class","dashicons dashicons-no-alt fail-icon")},always:function(){}})})),s(".deactivate-add-on").on("click",(function(a){var n=s(this),i=n.find("p"),t=n.find("span"),o=n.attr("data-slug"),d=JSON.parse(n.attr("data-nonce")).deactivate;a.preventDefault(),n.addClass("disabled"),i.text(ga_add_ons_js_vars.deactivating),t.attr("class","dashicons dashicons-update processing-icon"),e(o,d,{success:function(){i.text(ga_add_ons_js_vars.deactivated),t.attr("class","dashicons dashicons-yes success-icon"),window.location=ga_add_ons_js_vars.admin+"?page=grid-accordion-add-ons"},fail:function(){n.removeClass("disabled"),i.text(ga_add_ons_js_vars.try_again),t.attr("class","dashicons dashicons-no-alt fail-icon")},always:function(){}})}))}))}(jQuery);